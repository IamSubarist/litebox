import{G as L,r as n,j as l,a as e,R as $,Q as d,H as T,u as z,F,z as I,L as q,A as M}from"./index.1b2e2817.js";import{T as O}from"./Textinput.5dddae85.js";import{u as _}from"./index.esm.b9680bdc.js";import{c as K,a as A,o as G}from"./object.61533a39.js";import"./cleave-phone.us.195be213.js";import"./upperFirst.293d5b27.js";const C="https://socialdash.leverageindo.group/api",H=K({email:A().email("Invalid email").required("Email is Required"),password:A().min(6,"Password must be at least 6 characters").max(20,"Password shouldn't be more than 20 characters").required("Please enter password")}).required(),Q=({value:x,onChange:m,error:u})=>{const p=n.exports.useRef([]),[h,f]=n.exports.useState(["","","","","",""]);n.exports.useEffect(()=>{if(x){const t=x.split("").slice(0,6),a=[...h];t.forEach((s,o)=>{a[o]=s}),f(a)}},[x]);const E=(t,a)=>{var i;const s=a.target.value.replace(/[^0-9]/g,"");if(s.length>1)return;const o=[...h];o[t]=s,f(o),m(o.join("")),s&&t<5&&((i=p.current[t+1])==null||i.focus())},g=(t,a)=>{var s;a.key==="Backspace"&&!h[t]&&t>0&&((s=p.current[t-1])==null||s.focus())},P=t=>{var i;t.preventDefault();const a=t.clipboardData.getData("text").replace(/[^0-9]/g,"").slice(0,6),s=[...h];a.split("").forEach((S,b)=>{b<6&&(s[b]=S)}),f(s),m(s.join(""));const o=Math.min(a.length,5);(i=p.current[o])==null||i.focus()};return l("div",{className:"space-y-3",children:[e("label",{className:"form-label block capitalize text-center",children:"Enter your OTP Code"}),e("div",{className:"flex gap-2 justify-center",children:h.map((t,a)=>e("input",{ref:s=>p.current[a]=s,type:"text",inputMode:"numeric",maxLength:1,value:t,onChange:s=>E(a,s),onKeyDown:s=>g(a,s),onPaste:P,className:`form-control form-label w-12 h-12 text-center text-xl font-semibold border rounded-lg focus:outline-none focus:ring-1 focus:ring-primary-500 ${u?"border-danger-500":"border-slate-300 dark:border-slate-600"}  dark:text-white`},a))}),u&&e("div",{className:"text-danger-500 block text-sm mt-2",children:u})]})},U=()=>{const x=L(),[m,u]=n.exports.useState(1),[p,h]=n.exports.useState(""),[f,E]=n.exports.useState(""),[g,P]=n.exports.useState(""),[t,a]=n.exports.useState(!1),[s,o]=n.exports.useState(""),i=()=>localStorage.getItem("authToken"),{register:S,formState:{errors:b},handleSubmit:D}=_({resolver:G(H),mode:"all"}),B=async r=>{var w,v,N,k;if(t)return;const y=i();if(!y){d.error("Please login first");return}a(!0);try{const c=await T.post(`${C}/user/bind_login`,{login:r.email,password:r.password},{headers:{"Content-Type":"application/json",Authorization:y}});h(r.email),E(r.password),u(2),d.success("OTP code sent to your email")}catch(c){const j=((v=(w=c.response)==null?void 0:w.data)==null?void 0:v.message)||((k=(N=c.response)==null?void 0:N.data)==null?void 0:k.error)||"Failed to send OTP code";d.error(j)}finally{a(!1)}},R=async()=>{var y,w,v,N,k;if(t)return;if(g.length!==6){o("Please enter complete OTP code"),d.error("Please enter complete OTP code");return}const r=i();if(!r){d.error("Please login first");return}if(!p||!f){d.error("Session expired. Please start again."),u(1);return}a(!0),o("");try{const c=await T.post(`${C}/user/bind_login?code=${g}`,{login:p,password:f},{headers:{"Content-Type":"application/json",Authorization:r}});d.success(((y=c.data)==null?void 0:y.message)||"Account bound successfully"),setTimeout(()=>{x("/profile")},1500)}catch(c){const j=((v=(w=c.response)==null?void 0:w.data)==null?void 0:v.message)||((k=(N=c.response)==null?void 0:N.data)==null?void 0:k.error)||"Invalid OTP code or failed to bind account";o(j),d.error(j)}finally{a(!1)}};return l("div",{className:"space-y-5",children:[e("div",{className:"flex items-center justify-center gap-2 mb-6",children:[1,2].map(r=>l($.Fragment,{children:[e("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-semibold ${m>=r?"bg-primary-500 text-white":"bg-slate-200 dark:bg-slate-700 text-slate-500"}`,children:r}),r<2&&e("div",{className:`h-1 w-12 ${m>r?"bg-primary-500":"bg-slate-200 dark:bg-slate-700"}`})]},r))}),m===1&&l("form",{onSubmit:D(B),className:"space-y-5",children:[e(O,{name:"email",label:"email",type:"email",placeholder:" Enter your email",register:S,error:b.email,className:"h-[48px]"}),e(O,{name:"password",label:"password",type:"password",placeholder:" Enter your password",register:S,error:b.password,className:"h-[48px]",hasicon:!0}),e("button",{type:"submit",disabled:t,className:"btn btn-dark block w-full text-center disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Sending...":"Continue"})]}),m===2&&l("div",{className:"space-y-5",children:[e("div",{className:"w-full text-center flex items-center justify-center",children:e(Q,{value:g,onChange:P,error:s})}),l("div",{className:"flex gap-3",children:[e("button",{type:"button",onClick:()=>{u(1),P(""),o("")},className:"btn btn-outline-dark flex-1",disabled:t,children:"Back"}),e("button",{type:"button",onClick:R,disabled:g.length!==6||t,className:"btn btn-dark flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Binding...":"Bind account"})]})]})]})},ee=()=>(z(),l(F,{children:[e(I,{}),e("div",{className:"loginwrapper",children:l("div",{className:"lg-inner-column",children:[e("div",{className:"left-column relative z-[1]",children:e("div",{className:"absolute left-0 top-1/2 translate-y-[-50%] h-full w-full z-[-1] flex justify-center items-center",children:e("img",{src:"/icons/socseti.jpeg",alt:"",className:"h-full w-[95%] object-contain"})})}),e("div",{className:"right-column relative bg-white dark:bg-slate-800",children:l("div",{className:"inner-content h-full flex flex-col bg-white dark:bg-slate-800",children:[l("div",{className:"auth-box h-full flex flex-col justify-center",children:[e("div",{className:"mobile-logo text-center mb-6 lg:hidden block",children:l("div",{className:"flex items-center justify-center gap-2",children:[e(q,{to:"/",children:e("img",{src:M,alt:"",className:"mx-auto w-10 h-10"})}),e("p",{className:"text-2xl font-bold leading-[15px] text-white",children:"SocialDash"})]})}),l("div",{className:"text-center 2xl:mb-5 mb-4",children:[e("p",{className:"font-bold text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-[54px] mb-2",children:"Bind Your Email"}),e("div",{className:"text-slate-500 text-base sm:text-base md:text-[16px] lg:text-[16px] xl:text-[16px]",children:"Link your email account to your profile"})]}),e(U,{})]}),e("div",{className:"auth-footer text-center",children:"Copyright 2025, SocialDash All Rights Reserved."})]})})]})})]}));export{ee as default};
